"use strict";$(function(){var c={cate_one:"贵金属纪念币",cate_two:"熊猫币",material:"all",goodstime:"all",speci:"all",sort_method:"all",sort_type:"all",current:1,pagesize:12},s=0,o=[];function e(){$.get("./serve/getCate_list.php",c,function(t){var a,e,n;o=t.list,n="",(a=t).list.length?($(".off").addClass("hide"),a.list.forEach(function(t){n+='\n    <div class="pro_item" data-id="'.concat(t.goodsId,'">\n    <img data-id="').concat(t.goodsId,'" class="imgloading"  src="http://static.ecgci.com/images/git.png"\n      title="').concat(t.goodsinfo,'" alt="').concat(t.goodsinfo,'"  data-src="').concat(t.goodsimg,'"/>\n    <p class="it_title" data-id="').concat(t.goodsId,'">').concat(t.goodsname,'</p>\n    <p class="it_info">\n      <span class="item_price">').concat(t.price,'</span>\n      <i class="eval_num">已有13人评价</i>\n    </p>\n    <p class="item_oper">\n      <span class="addCart" data-id="').concat(t.goodsId,'">加入购物车</span> <span>关注</span>\n    </p>\n  </div>')}),$(".pro_list").html(n),e=$(".pro_list img"),$(window).on("scroll",function(){lazyLoad(e)})):$(".off").removeClass("hide"),s=(t=t).pageTotal,t=' \n    共<i class="page_goods">'.concat(t.goodsTotal,'</i>个商品 <i class="page_cur">').concat(c.current,'</i>/<i class="page_total">').concat(t.pageTotal,'</i>\n    <span class="pre_page ').concat(1==c.current?"unable":"",'" data-type="pre">\n      <b class="page_icon"></b>\n      上一页</span>\n    <span class="next_page ').concat(c.current==s?"unable":"",'" data-type="next" >下一页\n      <b class="page_icon"></b>\n    </span>'),$(".f2_r").html(t)},"json")}function i(){$.get("./serve/getCate_tree.php",{cate_one:c.cate_one,cate_two:c.cate_two},function(t){!function(t){var e,n="";for(e in t){n+='\n        <li>\n          <b class="f_title">'.concat(e,'</b>\n          <div class="f_item">');for(var a in t[e])!function(a){n+='<span class="cur " data-catethree="'.concat(a,'" data-type="all">不限</span>'),t[e][a].forEach(function(t){t[a]&&(n+='<span data-catethree="'.concat(a,'" data-type="').concat(t[a],'" >').concat(t[a],"</span>"))})}(a);n+="</div></li>"}$(".cate_f1 ul").html(n)}(t.list)},"json")}wxCodeShow(),loginSuccess(),loginout(),searchMsg(),$.get("./serve/getCate_one.php",function(t){$.get("./serve/getCate_two.php",function(n){var s='<h2 class="tree_all">所有分类</h2>';t.list.forEach(function(e){var t=n.list.filter(function(t){return e.cate_one==t.cate_one}),a=c.cate_one==e.cate_one;s+='\n         <div class="tree_f1">\n           <h3 data-cateone ="'.concat(e.cate_one,'" class="').concat(a?"tree_cur":"",'"><span class="').concat(a?"tree_cur":"",' tree_icon"></span> ').concat(e.cate_one,'</h3>\n           <ul  style="display:').concat(a?"block":"none",'">'),t.forEach(function(t){var a=c.cate_two==t.cate_two;s+='\n             <li class="'.concat(a?"tree_cur":"",'"   data-cateone="').concat(e.cate_one,'" data-catetwo="').concat(t.cate_two,'">').concat(t.cate_two,"</li>")}),s+="</ul></div> "}),$(".left_tree").html(s),$(".tree_f1").on("click","h3",function(){$(this).find("span").addClass("tree_cur"),$(this).addClass("tree_cur").siblings().slideDown(),$(this).parent().siblings().find("h3").removeClass("tree_cur").find("span").removeClass("tree_cur").parent().siblings().slideUp()}),$(".tree_f1").on("click","li",function(){$(this).addClass("tree_cur").siblings().removeClass("tree_cur"),$(this).parent().parent().siblings().find("li").removeClass("tree_cur");var t=$(this).attr("data-cateone"),a=$(this).attr("data-catetwo");c.cate_one=t,c.cate_two=a,i(),e()})},"json")},"json"),e(),i(),$(".cate_f2").on("click","span",function(){"next"==$(this).attr("data-type")&&c.current<s&&c.current++,"pre"==$(this).attr("data-type")&&1<c.current&&c.current--,e()}),$(".cate_f1").on("click","ul span",function(){$(this).addClass("cur").siblings().removeClass("cur");var t=$(this).attr("data-catethree"),a=$(this).attr("data-type");c[t]!=a&&(c[t]=a,e())}),$(".cate_f2").on("click",".f2_l span",function(){$(this).addClass("cur").siblings().removeClass("cur"),$(this).find("b").toggleClass("up").parent().siblings().find("b").addClass("up"),c.sort_method=$(this).attr("data-method"),c.sort_type=$(this).attr("data-type"),e(),$(this).attr("data-type","DESC"==c.sort_type?"ASC":"DESC").siblings().attr("data-type","DESC")}),$(".page").on("click","p  span",function(){$(this).addClass("cur").siblings().removeClass("cur")}),$(".f1_r").on("click",function(){c.material="all",c.goodstime="all",c.speci="all",e(),i()}),$(".pro_list").on("click",".addCart",function(){var t=JSON.parse(localStorage.getItem("goods"))||[],a=$(this).attr("data-id"),e=o.filter(function(t){return t.goodsId==a})[0];t.some(function(t){return t.goodsId==a})?t.filter(function(t){return t.goodsId==a})[0].goodsnum+=1:(e.goodsnum=1,e.is_select=!1,t.push(e)),layer.alert("加入购物车成功",{icon:1}),localStorage.setItem("goods",JSON.stringify(t))}),$(".pro_list").on("click","img,.it_title",function(){location.href="./detail.html?keyVal="+$(this).attr("data-id")})});